# Let's start playing with our data
# We look to the output file tagsByTime.out 
# This file, we expect, is generated by parsing out a collection of log files.
# Each row represents a 10 minute period of the same day and each column represents the count 
# of log tags accumulated in that time frame.
# e.g. 12   1   4
# would represent the 12th 10 minute segment of the day (1:50 am - 2:00 am), 1 debug log, and 4 warning logs
# Knowing what columns fit with which log tag is needed a priori knowledge. 
# I could make the columns explicit in the out file, but I'm lazy and don't feel like it; maybe another day.
# I'll list the order here (note this is subject to change without warning)
# DEBUG, VERBOSE, INFO, WARN, ERROR, FATAL
# ==========================================================================
tags = c("DEBUG", "VERBOSE", "INFO", "WARN", "ERROR", "FATAL")

# Hmm, (can we)/(should we) use one of our config files (%projectRoot%/conf/dirpaths.conf) that our python scripts use to 
# derive relative paths for us?
# In through the out door. This data is expected to already be wrangled and formatted properly for us.
infile = "./../data/output/tagsByTime.out"

# data is expected to be structured such that each row is a different time segment and 
# each column beyond the first is the count of the log tags counted in that time segment.
# 1   12    0   3
# 2   13    0   1
# ...
data <- read.table(infile, sep = "", header = F, nrows = 144, na.strings = "", stringsAsFactors = F)

# We expect the data is now structured such that
# data[1] contains the array of all elemnts in the first column (time seg)
# data[2] contains the array of all elemnts in the second column 

# What are my maximum values for:
# DEBUG, VERBOSE, INFO, WARN, ERROR, FATAL
print("=============== Maximums ===============")
for(i in 2:7){
  print(paste("Max ", tags[i-1]))
  print(max(data[i]))
}

# What are my minimum values for:
# DEBUG, VERBOSE, INFO, WARN, ERROR, FATAL
print("=============== Minimums ===============")
for(i in 2:7){
  print(paste("Min ", tags[i-1]))
  print(min(data[i]))
}

# What are my arithmatic means for:
# DEBUG, VERBOSE, INFO, WARN, ERROR, FATAL
print("=============== Mean (arithimatic) ===============")
for (i in 2:7){
  print(paste("Mean ", tags[i-1]))
  print(mean(unlist(data[i])))
}

# What are my standard deviations for:
# DEBUG, VERBOSE, INFO, WARN, ERROR, FATAL
print("=============== Standard Deviation ===============")
for (i in 2:7){
  print(paste("Std Dev ", tags[i-1]))
  print(sd (unlist(data[i])))
}

# Is there a correlation between debug and error:
# 2DEBUG, 3VERBOSE, 4INFO, 5WARN, 6ERROR, 7FATAL
print("=============== Debug / Error Correlation ===============")
print(cor(data[2], data[6], use="all.obs", method="pearson"))

# Commented out since verbose logging is turned off.
# R will complain if the standard deviation is 0. i.e. c(0,0,...,0)
# Is there a correlation between debug and error:
# 2DEBUG, 3VERBOSE, 4INFO, 5WARN, 6ERROR, 7FATAL
#print("=============== Verbose / Error Correlation ===============")
#print(cor(data[3], data[6], use="all.obs", method="pearson"))

# Is there a correlation between debug and error:
# 2DEBUG, 3VERBOSE, 4INFO, 5WARN, 6ERROR, 7FATAL
print("=============== Info / Error Correlation ===============")
print(cor(data[4], data[6], use="all.obs", method="pearson"))

# Is there a correlation between warnings and errors:
# 2DEBUG, 3VERBOSE, 4INFO, 5WARN, 6ERROR, 7FATAL
print("=============== Warning / Error Correlation ===============")
print(cor(data[5], data[6], use="all.obs", method="pearson"))

# Is there a correlation between warnings and errors:
# 2DEBUG, 3VERBOSE, 4INFO, 5WARN, 6ERROR, 7FATAL
print("=============== Error / Error Correlation ===============")
print(cor(data[6], data[6], use="all.obs", method="pearson"))

# Is there a correlation between warnings and errors:
# 2DEBUG, 3VERBOSE, 4INFO, 5WARN, 6ERROR, 7FATAL
print("=============== Debug / Warn Correlation ===============")
print(cor(data[2], data[5], use="all.obs", method="pearson"))

# Is there a correlation between warnings and errors:
# 2DEBUG, 3VERBOSE, 4INFO, 5WARN, 6ERROR, 7FATAL
print("=============== Debug / Info Correlation ===============")
print(cor(data[2], data[4], use="all.obs", method="pearson"))





# Draw line of best fit
# abline(lm(unlist(data[2]) ~ unlist(data[1]), data=data[2]))



# compdata = c(data[2], data[5])
# lm(V2 ~ V5, data = compdata)











